
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.superinsight.ai/en/operations/train/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Train - Superinsight Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.08040f6c.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#train-custom-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../" title="Superinsight Documentation" class="md-header__button md-logo" aria-label="Superinsight Documentation" data-md-component="logo">
      
  <img src="../../../assets/images/superinsight/logo_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Superinsight Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Train
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="Superinsight Documentation" class="md-nav__button md-logo" aria-label="Superinsight Documentation" data-md-component="logo">
      
  <img src="../../../assets/images/superinsight/logo_white.png" alt="logo">

    </a>
    Superinsight Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        What is Superinsight
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        Quickstart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/dataset/" class="md-nav__link">
        Dataset
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Operations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Operations" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../create/" class="md-nav__link">
        Create
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../delete/" class="md-nav__link">
        Delete
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../drop/" class="md-nav__link">
        Drop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../insert/" class="md-nav__link">
        Insert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../search/" class="md-nav__link">
        Search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../predict/" class="md-nav__link">
        Predict
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Train
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Train
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#train-custom-models" class="md-nav__link">
    Train custom models
  </a>
  
    <nav class="md-nav" aria-label="Train custom models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#text-classification" class="md-nav__link">
    Text Classification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommender" class="md-nav__link">
    Recommender
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summarization" class="md-nav__link">
    Summarization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#translation" class="md-nav__link">
    Translation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../update/" class="md-nav__link">
        Update
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://www.superinsight.ai" class="md-nav__link">
        Official Website
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#train-custom-models" class="md-nav__link">
    Train custom models
  </a>
  
    <nav class="md-nav" aria-label="Train custom models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#text-classification" class="md-nav__link">
    Text Classification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommender" class="md-nav__link">
    Recommender
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summarization" class="md-nav__link">
    Summarization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#translation" class="md-nav__link">
    Translation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Train</h1>

<h2 id="train-custom-models">Train custom models</h2>
<p>To train your own custom model, you can choose a pretrained ML model as a based model, and finetuned it with your own data</p>
<div class="admonition warning">
<p class="admonition-title">Prerequisite</p>
<p>GPU is required for training custom models. This feature is currently only available in the distributed version.</p>
</div>
<table>
<thead>
<tr>
<th>Task</th>
<th>Description</th>
<th>Model Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Text Classification</td>
<td>Use to assign label or class to text, labels such as sentiment or product category</td>
<td>model.text_classification</td>
</tr>
<tr>
<td>Question Answering</td>
<td>Use to find answers in a large amount of text</td>
<td>model.question_answering</td>
</tr>
<tr>
<td>Recommender</td>
<td>Use to recommend items to user base on collaborative filtering</td>
<td>model.recommender</td>
</tr>
<tr>
<td>Summarization</td>
<td>Use to summarize a large amount of text to a short description</td>
<td>model.summarization</td>
</tr>
<tr>
<td>Text Generation</td>
<td>Use to generate text from a preceding example</td>
<td>model.text_generation</td>
</tr>
<tr>
<td>Translation</td>
<td>Use for translating one language to another, for example English to French</td>
<td>model.translation</td>
</tr>
</tbody>
</table>
<h3 id="text-classification">Text Classification</h3>
<p>Text classification can be use to generate labels from text. For example, let's say you want to train your own custom model to determine the generes of movies, you run the following query to train a model using specific training data from table <code>movie</code> and using the base model <code>text_classification</code> for fine tuning.</p>
<p>To prepare the training dataset, we can run the following query to get the the text and labels
<div class="highlight"><pre><span></span><code>SELECT movie.overview as text, movie.genre as labels FROM mldb.movie as movie
</code></pre></div></p>
<table>
<thead>
<tr>
<th>text</th>
<th>labels</th>
</tr>
</thead>
<tbody>
<tr>
<td>Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.</td>
<td>Drama</td>
</tr>
<tr>
<td>An organized crime dynasty's aging patriarch transfers control of his clandestine empire to his reluctant son.</td>
<td>Crime, Drama</td>
</tr>
<tr>
<td>When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.</td>
<td>Action, Crime, Drama</td>
</tr>
</tbody>
</table>
<p>To train a custom model, we can run the following query
<div class="highlight"><pre><span></span><code>CREATE MODEL model.my_movie_classification_model
FROM (SELECT movie.overview as text, movie.genre as labels FROM mldb.movie) as training_data
WHERE MODEL_NAME = &#39;text_classification&#39;
</code></pre></div></p>
<table>
<thead>
<tr>
<th>model_id</th>
<th>model_name</th>
<th>model_type</th>
<th>training_data</th>
<th>status</th>
</tr>
</thead>
<tbody>
<tr>
<td>my_model_id</td>
<td>movie_genre_classification_model</td>
<td>text_classification</td>
<td>SELECT movie.overview as text, movie.genre as labels FROM mldb.movie</td>
<td>initializing</td>
</tr>
</tbody>
</table>
<h3 id="recommender">Recommender</h3>
<p>Recommender can be use to predict items that a user will be interested in base on other users with similar interests. For example, let's say we want recommend movies to our users.  We can use a database table of movie rating to trained our custom model. To get this sample data, import it from <a href="/setup/dataset/#movie-rating">movie rating dataset</a>.</p>
<table>
<thead>
<tr>
<th>user_id</th>
<th>movie_id</th>
<th>rating</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>31</td>
<td>2.5</td>
</tr>
<tr>
<td>1</td>
<td>1029</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>To prepare a training dataset with only the column name <code>user_id</code> and <code>item_id</code> for the model. Movies are rated from 1-5, and since we only need positive rating in our training data, we can run the following query to create the training data for positive reviews higher than 3. To preview the training data we can run the following query
<div class="highlight"><pre><span></span><code>SELECT user_id as user_id, movie_id as item_id FROM mldb.movie_rating WHERE mldb.movie_rating.rating &gt; 3
</code></pre></div></p>
<table>
<thead>
<tr>
<th>user_id</th>
<th>item_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1172</td>
</tr>
<tr>
<td>1</td>
<td>1339</td>
</tr>
</tbody>
</table>
<p>We can then run the following query to train a model under the name <code>my_movie_recommender_model</code> using our training_data. To indicate that this training is for a recommender model, we will need to pass in the condition <code>MODEL_NAME = 'recommender'</code>
<div class="highlight"><pre><span></span><code>CREATE MODEL model.my_movie_recommender_model
FROM (SELECT user_id as user_id, movie_id as item_id FROM mldb.movie_rating WHERE mldb.movie_rating.rating &gt; 3) as training_data
WHERE MODEL_NAME = &#39;recommender&#39;
</code></pre></div></p>
<table>
<thead>
<tr>
<th>model_id</th>
<th>model_name</th>
<th>model_type</th>
<th>training_data</th>
<th>status</th>
</tr>
</thead>
<tbody>
<tr>
<td>my_model_id</td>
<td>my_movie_recommender_model</td>
<td>recommender</td>
<td>SELECT user_id as user_id, movie_id as item_id FROM mldb.movie_rating WHERE mldb.movie_rating.rating &gt; 3</td>
<td>initializing</td>
</tr>
</tbody>
</table>
<p>The result set will provide the <code>model_id</code> for our custom model. To make predictions for this model, continue at <a href="/operations/predict/#recommender">predict recommender model</a>.</p>
<h3 id="summarization">Summarization</h3>
<p>Summarization can be use to summarize a large amount of text to a short description . For example, let's say you want to train a custom model to summarize the movie description to a few lines, you run the following query to train a model using specific training data from table <code>movie</code> and using the base model <code>summarization</code> for fine tuning.</p>
<div class="highlight"><pre><span></span><code>SELECT movie.overview as summary, movie.description as source FROM mldb.movie
</code></pre></div>
<table>
<thead>
<tr>
<th>summary</th>
<th>source</th>
</tr>
</thead>
<tbody>
<tr>
<td>Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.</td>
<td>......</td>
</tr>
<tr>
<td>An organized crime dynasty's aging patriarch transfers control of his clandestine empire to his reluctant son.</td>
<td>......</td>
</tr>
</tbody>
</table>
<p>To train a custom model, we can run the following query
<div class="highlight"><pre><span></span><code>CREATE MODEL model.my_movie_summarization_model
FROM (SELECT movie.overview as summary, movie.description as source FROM mldb.movie) as training_data
WHERE MODEL_NAME = &#39;summarization&#39;
</code></pre></div></p>
<table>
<thead>
<tr>
<th>model_id</th>
<th>model_name</th>
<th>model_type</th>
<th>training_data</th>
<th>status</th>
</tr>
</thead>
<tbody>
<tr>
<td>my_model_id</td>
<td>my_movie_summarization_model</td>
<td>summarization</td>
<td>SELECT movie.overview as summary, movie.details as source FROM mldb.movie</td>
<td>initializing</td>
</tr>
</tbody>
</table>
<h3 id="translation">Translation</h3>
<p>Translation model can be use to translate text from one language to another. For example, let's say you want to train a custom model to do french translation for caption in your movies, you run the following query to train a model using specific training data from table <code>movie_captions</code> and using the base model <code>translation</code> for fine tuning.</p>
<p>To get the training data, we can run the following query
<div class="highlight"><pre><span></span><code>SELECT captions.orignal as source, captions.french as target FROM mldb.movie_captions as captions where language = &#39;french&#39;
</code></pre></div></p>
<table>
<thead>
<tr>
<th>source</th>
<th>target</th>
</tr>
</thead>
<tbody>
<tr>
<td>Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.</td>
<td>Deux hommes emprisonnés se lient pendant plusieurs années, trouvant un réconfort et une éventuelle rédemption grâce à des actes de décence commune.</td>
</tr>
<tr>
<td>An organized crime dynasty's aging patriarch transfers control of his clandestine empire to his reluctant son.</td>
<td>Le patriarche vieillissant d'une dynastie du crime organisé transfère le contrôle de son empire clandestin à son fils réticent.</td>
</tr>
</tbody>
</table>
<p>To train a custom model, we can run the following query
<div class="highlight"><pre><span></span><code>CREATE MODEL model.movie_french_translation_model
FROM (SELECT captions.orignal as source, captions.french as target FROM mldb.movie_captions as captions where language = &#39;french&#39;) as training_data
WHERE MODEL_NAME = &#39;translation&#39;
</code></pre></div></p>
<table>
<thead>
<tr>
<th>model_id</th>
<th>model_name</th>
<th>model_type</th>
<th>training_data</th>
<th>status</th>
</tr>
</thead>
<tbody>
<tr>
<td>my_model_id</td>
<td>my_movie_translation_model</td>
<td>translation</td>
<td>SELECT captions.orignal as source, captions.french as target FROM mldb.movie_captions as captions where language = 'french'</td>
<td>initializing</td>
</tr>
</tbody>
</table>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../predict/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Predict" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Predict
            </div>
          </div>
        </a>
      
      
        
        <a href="../update/" class="md-footer__link md-footer__link--next" aria-label="Next: Update" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Update
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>